<!DOCTYPE html><html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="Jinge's Blog on Github"><title>&lt;&lt;JavaScript Ninja&gt;&gt; - Notes | Jinge's Blog</title><link rel="stylesheet" type="text/css" href="/css/normalize.css"><link rel="stylesheet" type="text/css" href="/css/highlight.css"><link rel="stylesheet" type="text/css" href="/css/noise.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/font-awesome/4.5.0/css/font-awesome.min.css"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="alternate" type="application/atom+xml" href="/atom.xml"></head><body><!-- gallery that comes before the header--><article class="wrapper"><div class="post-main"><div class="nav"><nav class="container"><a href="/" class="sidebar-nav-item active">Home</a><a href="/archives" class="sidebar-nav-item">Archives</a></nav><div class="container post-meta"><div class="post-time">2016-12-24</div></div></div><div class="container post-header"><h1>&lt;&lt;JavaScript Ninja&gt;&gt; - Notes</h1></div><div class="container post-content"><h2 id="第-3-章-函数是根基">第 3 章 函数是根基</h2>
<h3 id="回调函数-compare">回调函数 <code>compare()</code></h3>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">var values = [213, 16, 2058, 54, 10];</div><div class="line">values.sort(function(val1, val2) &#123;</div><div class="line">    return val2 - val1; &#125;);</div><div class="line">console.log(values);</div><div class="line">// [ 2058, 213, 54, 16, 10 ]</div></pre></td></tr></table></figure>
<p><code>compare()</code> 已知都没有完全弄懂，看了这本书完全懂了。</p>
<p><code>sort()</code> 按顺序将两个相邻的数放入<code>compare()</code>中，如果计算得到的结果<code>&gt;0</code>，则需要互换位置。</p>
<h3 id="作用域">作用域</h3>
<p><code>变量的作用域开始于声明的地方，结束于所在函数的末尾，与代码嵌套无关。</code></p>
<p><code>命名函数的作用域是指声明该函数的整个 函数范围 ，与代码嵌套无关。</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">function() &#123;</div><div class="line">  // `function innner()`&apos;s scope starts here</div><div class="line">  var a = 1;</div><div class="line">  function inner() &#123;/*...*/&#125;</div><div class="line">  var b = 2;</div><div class="line">  if (a == 1) &#123;</div><div class="line">    var c = 3; // `var c`&apos;s scope starts here</div><div class="line">  &#125; // this </div><div class="line">  // `var c`&apos;s scope ends here</div><div class="line">  // `function innner()`&apos;s scope ends here</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="从参数到函数形式参数">从参数到函数形式参数</h3>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">function juggle(a, b) &#123;</div><div class="line">    console.log(arguments);</div><div class="line">    console.log(typeof arguments);</div><div class="line">    console.log(this);</div><div class="line">&#125;</div><div class="line"></div><div class="line">juggle(1, 2, 3);</div><div class="line">// console.log(arguments); // &#123; &apos;0&apos;: 1, &apos;1&apos;: 2, &apos;2&apos;: 3 &#125;</div></pre></td></tr></table></figure>
<p>函数调用隐含了两个参数<code>this</code>与<code>arguments</code>，<code>this</code> 是调用此函数的上下文，<code>arguments</code>是调用此函数的参数列表（Object），不是数组。虽然也可以使用arguments[i]来获取里面的值，但是请注意JavaScript语言的特性，i 可以是 number 也可以是字符串，可以这么访问里面的数据，并不表示它是一个数组。</p>
<p>可以传多余多余函数形参个数的参数给函数，多余的参数不会赋值给任何形参，而是保存在<code>arguments</code>中。</p>
<h3 id="函数调用的四种方法">函数调用的四种方法</h3>
<p>重点在函数的上下文</p>
<blockquote>
<ol style="list-style-type: decimal">
<li>作为一个函数（function）进行调用，是最简单的形式。</li>
<li>作为一个方法（method）进行调用，在对象上进行调用，支持面向对象编程。</li>
<li>作为构造器（constructor）进行调用，创建一个新对象。</li>
<li>通过<code>apply()</code>或<code>call()</code>方法进行调用。</li>
</ol>
</blockquote>
<h4 id="作为函数调用">1. 作为函数调用</h4>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">function ninja() &#123;</div><div class="line">  console.log(this);</div><div class="line">&#125;</div><div class="line">ninja();</div></pre></td></tr></table></figure>
<p>上下文环境<code>this</code>指向 window 对象（浏览器中）或 process 对象（nodejs中）。</p>
<h4 id="作为方法调用">2. 作为方法调用</h4>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">var o = &#123;name: &apos;o Object&apos;&#125;;</div><div class="line">o.whatever = function() &#123;</div><div class="line">  console.log(this);</div><div class="line">&#125;</div><div class="line">o.whatever(); // &#123; name: &apos;o Object&apos;, whatever: [Function] &#125;</div></pre></td></tr></table></figure>
<p>上下文环境<code>this</code>指向调用方法的 Object。</p>
<h4 id="作为构造器调用">3. 作为构造器调用</h4>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">function Ninja() &#123;</div><div class="line">  this.skulk = function() &#123;return this;&#125;</div><div class="line">&#125;</div><div class="line">var ninja1 = new Ninja();</div><div class="line">console.log(ninja1.skulk() === ninja1); // true</div></pre></td></tr></table></figure>
<p><code>在使用 new 关键字进行调用时，将会创建一个空对象实例，并作为 this 参数传递给该函数。</code></p>
<h4 id="使用apply和call方法进行调用">4. 使用<code>apply()</code>和<code>call()</code>方法进行调用</h4>
<p>明确指明上下文环境<code>this</code>。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">function juggle() &#123;</div><div class="line">  console.log(arguments);</div><div class="line">  console.log(this);</div><div class="line">&#125;</div><div class="line"></div><div class="line">var ninja1 = &#123;name: &apos;ninja1&apos;&#125;;</div><div class="line">var ninja2 = &#123;name: &apos;ninja2&apos;&#125;;</div><div class="line"></div><div class="line">juggle.apply(ninja1, [1,2,3]); // ninja1是上下文环境，[1,2,3]是参数数组（可以不同类型，如[1,2,&apos;3&apos;]）</div><div class="line">// &#123; &apos;0&apos;: 1, &apos;1&apos;: 2, &apos;2&apos;: 3 &#125;</div><div class="line">// &#123; name: &apos;ninja1&apos; &#125;</div><div class="line">juggle.apply(ninja2, 1, 2, 3); // ninja2是上下文环境，后面是参数列表，不是以数组形式传递</div><div class="line">// &#123; &apos;0&apos;: 1, &apos;1&apos;: 2, &apos;2&apos;: 3 &#125;</div><div class="line">// &#123; name: &apos;ninja2&apos; &#125;</div></pre></td></tr></table></figure>
<h2 id="第-4-章-挥舞函数">第 4 章 挥舞函数</h2>
<h3 id="递归">递归</h3>
<p>回文： 1. 字符串为空，或者只有一个字符，是回文； 2. 字符串首尾字符相等，并且去除首尾字符后的子串是回文，则该字符串是回文。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">function isPalindrome(text) &#123;</div><div class="line">    if (text.length &lt;= 1) return true;</div><div class="line">    else if (text.charAt(0) != text.charAt(text.length - 1)) return false;</div><div class="line">    return isPalindrome(text.substring(1, text.length - 1));</div><div class="line">    // return isPalindrome(text.substr(1, text.length - 2));</div><div class="line">&#125;</div><div class="line"></div><div class="line">var text = &quot;abccba&quot;;</div><div class="line">console.log(&quot;&apos;&quot; + text + &quot;&apos; is palindrome? &quot; + isPalindrome(text));</div><div class="line">// &apos;abccba&apos; is palindrome? true</div><div class="line">text = &quot;abbb&quot;;</div><div class="line">console.log(&quot;&apos;&quot; + text + &quot;&apos; is palindrome? &quot; + isPalindrome(text));</div><div class="line">// &apos;abbb&apos; is palindrome? false</div></pre></td></tr></table></figure>
<p><code>String</code>有两个函数能够得到子串，<code>substring(from, to)</code>，<code>substr(start, length)</code>，注意第二个参数含义的不同。</p>
<h3 id="自记忆函数">自记忆函数</h3>
<p>函数也是一个 Object，可以将一些函数计算的结果存储在函数 Object 中，方便以后的使用。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">function isPrime(value) &#123;</div><div class="line">  if (!isPrime.answers) isPrime.answers = &#123;&#125;;</div><div class="line">  if (isPrime.answers[value] != null) &#123;</div><div class="line">    return isPrime.answers[values];</div><div class="line">  &#125;</div><div class="line">  var prime = value != 1;</div><div class="line">  for (var i = 2; i &lt; value; ++i) &#123;</div><div class="line">    if (value % i == 0) &#123;</div><div class="line">      prime = false;</div><div class="line">      break;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  return isPrime.answers[value] = prime;</div><div class="line">&#125;</div><div class="line"></div><div class="line">console.log(&apos;2 is Prime? &apos; + isPrime(2));</div><div class="line">// 2 is Prime? true</div><div class="line">console.log(&apos;3 is Prime? &apos; + isPrime(3));</div><div class="line">// 3 is Prime? true</div><div class="line">console.log(&apos;4 is Prime? &apos; + isPrime(4));</div><div class="line">// 4 is Prime? false</div><div class="line">console.log(isPrime);</div><div class="line">// &#123; [Function: isPrime] answers: &#123; &apos;2&apos;: true, &apos;3&apos;: true, &apos;4&apos;: false &#125; &#125;</div></pre></td></tr></table></figure>
<h3 id="伪造数组方法">伪造数组方法</h3>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line">&lt;body&gt;</div><div class="line">    &lt;input id=&quot;first&quot;&gt;&lt;/input&gt;</div><div class="line">    &lt;input id=&quot;second&quot;&gt;&lt;/input&gt;</div><div class="line">    &lt;script type=&quot;text/javascript&quot;&gt;</div><div class="line">    function assert(value, desc) &#123;</div><div class="line">        var li = document.createElement(&quot;li&quot;);</div><div class="line">        li.className = value ? &quot;pass&quot; : &quot;fail&quot;;</div><div class="line">        li.appendChild(document.createTextNode(desc));</div><div class="line">        document.getElementById(&quot;results&quot;).appendChild(li);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    window.onload = function() &#123;</div><div class="line">      var elems = &#123;</div><div class="line">        length: 0,</div><div class="line">        add: function(elem) &#123; // 当前的应用不会在外部调用add函数，相当于私有函数。</div><div class="line">          Array.prototype.push.call(this, elem);</div><div class="line">          // 将 elems 自生作为上下文环境调用Array的push函数，Array的push函数能够给length自增1。</div><div class="line">        &#125;,</div><div class="line">        gather: function(id) &#123;</div><div class="line">          this.add(document.getElementById(id));</div><div class="line">        &#125;</div><div class="line">      &#125;</div><div class="line"></div><div class="line">      elems.gather(&quot;first&quot;);</div><div class="line">      elems.gather(&quot;second&quot;);</div><div class="line">      console.log(elems);</div><div class="line">    &#125;</div><div class="line">    &lt;/script&gt;</div><div class="line">&lt;/body&gt;</div></pre></td></tr></table></figure>
<h3 id="可变长度的参数列表">可变长度的参数列表</h3>
<p>JavaScript 没有函数重载，可以回想一下 C++ 的函数重载方式。</p>
<p>JavaScript 的函数 signature 不存在形参的类型、返回值类型，如果能够重载也只是重载形参的个数。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div></pre></td><td class="code"><pre><div class="line">// object 上添加名字为 name 的函数 fn。</div><div class="line">function addMethod(object, name, fn) &#123;</div><div class="line">// 考虑到 object 中有可能存在名字相同的函数，将其进行保存，定义规则保证在参数个数不同的情况下可以执行 fn 与已经存在的函数。</div><div class="line">  var old = object[name];</div><div class="line">  // 重新定义 object 名为 name 的属性，其为一个函数</div><div class="line">  object[name] = function() &#123;</div><div class="line">  // 传入参数的个数与 fn 的形参个数相同，则调用 fn</div><div class="line">    if (fn.length == arguments.length) &#123;</div><div class="line">      return fn.apply(this, arguments);</div><div class="line">  // 否则调用 old。</div><div class="line">    &#125; else if (typeof old == &apos;function&apos;)&#123;</div><div class="line">      return old.apply(this, arguments);</div><div class="line">    &#125;</div><div class="line">  &#125;;</div><div class="line">&#125;</div><div class="line"></div><div class="line">var ninjas = &#123; values: [&apos;Dean Edwards&apos;, &apos;Sam Stephenson&apos;, &apos;Alex Russell&apos;] &#125;;</div><div class="line"></div><div class="line">addMethod(ninjas, &apos;find&apos;, function() &#123;</div><div class="line">  return this.values;</div><div class="line">&#125;);</div><div class="line"></div><div class="line">addMethod(ninjas, &apos;find&apos;, function(name) &#123;</div><div class="line">  var ret = [];</div><div class="line">  for (var i = 0; i &lt; this.values.length; ++i)</div><div class="line">    if (this.values[i].indexOf(name) == 0)</div><div class="line">      ret.push(this.values[i]);</div><div class="line">  return ret;</div><div class="line">&#125;);</div><div class="line"></div><div class="line">addMethod(ninjas, &apos;find&apos;, function(first, last) &#123;</div><div class="line">  var ret = [];</div><div class="line">  for (var i = 0; i &lt; this.values.length; ++i)</div><div class="line">    if (this.values[i] == (first + &quot; &quot; + last))</div><div class="line">      ret.push(this.values[i]);</div><div class="line">  return ret;</div><div class="line">&#125;);</div><div class="line"></div><div class="line">console.log(ninjas.find(&apos;Dean&apos;, &apos;Edwards&apos;));</div><div class="line"></div><div class="line">console.log(ninjas.find(&apos;Dean&apos;));</div><div class="line"></div><div class="line">console.log(ninjas.find());</div></pre></td></tr></table></figure>
<h2 id="第-5-章-闭包">第 5 章 闭包</h2>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">var outValue = &apos;ninja&apos;;</div><div class="line"></div><div class="line">var later;</div><div class="line"></div><div class="line">function outerFunction() &#123;</div><div class="line">  var innerValue = &apos;samurai&apos;;</div><div class="line"></div><div class="line">  function innerFunction() &#123;</div><div class="line">    console.log(&apos;outValue exists? &apos; + (typeof outValue !== undefined));</div><div class="line">    console.log(&apos;innerValue exists? &apos; + (typeof innerValue !== undefined));</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  later = innerFunction;</div><div class="line">&#125;</div><div class="line"></div><div class="line">outerFunction();</div><div class="line"></div><div class="line">later();</div></pre></td></tr></table></figure>
</div></div><div class="post-main post-comment"></div></article><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.css"><script src="//cdn.bootcss.com/jquery/2.0.3/jquery.min.js"></script><script src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js"></script><script>$(document).ready(function() {
    $(".fancybox").fancybox();
});
</script></body><script type="text/x-mathjax-config">MathJax.Hub.Config({
  tex2jax: {
  inlineMath: [ ['$','$'], ["\\(","\\)"] ],
  processEscapes: true
  }
});</script><script type="text/x-mathjax-config">MathJax.Hub.Config({
  tex2jax: {
  skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
  }
});</script><script type="text/x-mathjax-config">MathJax.Hub.Queue(function() {
   var all = MathJax.Hub.getAllJax(), i;
   for(i=0; i < all.length; i += 1) {
       all[i].SourceElement().parentNode.className += ' has-jax';
   }
});</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script></html>